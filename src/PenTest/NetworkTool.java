package PenTest;

import java.io.IOException;
import java.net.Socket;
import java.util.HashMap;
import java.util.Properties;

public class NetworkTool {

	static HashMap<Integer, Boolean> scanPortBulk(String hostname)
	{
		/*	bulk port scanner	*/
		HashMap<Integer, Boolean> result = new HashMap<Integer, Boolean>();
		PropLoader propLoader = new PropLoader();
		Properties portList = propLoader.getPropValues("port");

		String portListString = portList.getProperty("port");			
		String [] portListArray = portListString.split(",");
		for(String portString: portListArray)
		{
			int port = Integer.parseInt(portString);
			System.out.println("scan port: " + port);
			if(NetworkTool.scanPort(hostname, port) == true)
			{
				result.put(port, true);
			}
			else
			{
				result.put(port, false);
			}
		}
		
		return result;
	}


	static Boolean scanPort(String hostname, int port)
	{
		/*	single port scanner	*/
		Boolean status = false;
		Socket s = null;

		try {
			s = new Socket(hostname, port);
			status = true;

		} catch (IOException e) {
			status = false;
			return status;
		} finally {
			if( s != null){
				try {
					s.close();
				} catch (IOException e) {
					ErrorHandler.write(e);
				}
			}
		}
		return status;
	}
}

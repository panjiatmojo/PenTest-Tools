package PenTest;

import java.io.IOException;
import java.net.InetSocketAddress;
import java.net.Socket;
import java.util.HashMap;

public class NetworkTool {

	static HashMap<Integer, Boolean> scanPortBulk(String hostname)
	{
		/*	bulk port scanner	*/
		HashMap<Integer, Boolean> result = new HashMap<Integer, Boolean>();

		String portListString = "";
		try {
			portListString = FileInterface.read("resources/data/port-list.txt");
		} catch (Exception e) {
			ErrorHandler.write(e);
		}
		String [] portListArray = portListString.split("[\r\n]+");
		for(String portString: portListArray)
		{
			int port = Integer.parseInt(portString);
			System.out.println("scan port: " + port);
			if(NetworkTool.scanPort(hostname, port) == true)
			{
				result.put(port, true);
			}
			else
			{
				result.put(port, false);
			}
		}

		return result;
	}


	static Boolean scanPort(String hostname, int port)
	{
		/*	single port scanner	*/
		Boolean status = false;
		Socket socket = null;

		try {
			socket = new Socket();
			socket.connect(new InetSocketAddress(hostname, port), 1000);

		} catch (IOException e) {
			status = false;
			return status;
		} finally {
			if( socket != null){
				try {
					socket.close();
				} catch (IOException e) {
					ErrorHandler.write(e);
				}
			}
		}
		return status;
	}
}

package PenTest;

import java.util.ArrayList;
import java.util.HashMap;

public class DomainReverse {

	static ArrayList<String> getData(String hostname)
	{
		hostname = hostname.replaceAll("http(s)*://", "");
		String pattern = "http://viewdns.info/reverseip/?host="+hostname+"&t=1";
		HashMap<String, Object> response = UrlFetch.get(pattern);

		ArrayList<String> domain = getDomainList(String.valueOf(response.get("content")));

		return domain;
	}

	static ArrayList<String> getDomainList(String response)
	{
		ArrayList<String> domain = null;

		String pattern1 = "(<table.+?Domain.+?Last\\sResolved\\sDate.+?</table>)";
		ArrayList<String> table = Parser.parse(response, pattern1, 1);

		if(table.get(0) != null)
		{
			String pattern2 = "<tr>.*?<td>([a-z0-9-\\.]+?)</td>.+?</tr>";			
			domain = Parser.parse(table.get(0), pattern2, 1);
		}

		return domain;
	}
}
